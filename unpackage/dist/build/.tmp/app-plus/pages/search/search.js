(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{3071:function(t,e,a){"use strict";a.r(e);var s=a("f2bf"),o=a("f884");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("4c08");var r=a("2877"),n=Object(r["a"])(o["default"],s["a"],s["b"],!1,null,null,null);e["default"]=n.exports},4373:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=getApp().globalData,o=a("28c1"),i=function(){return a.e("components/goodList/goodList").then(a.bind(null,"bc0e"))},r={data:function(){return{focus:!0,hotKeyShow:!0,historyKeyShow:!0,searchValue:"",page:1,shopList:[],historyKeyList:[],hotKeyList:[],page_size:10,reachBottom:!1,hotWord:[],keyword:"",showEmpty:!1,sort:"normal",hotAndHistoryHidden:!1,iconUrl:s.dataBase.iconURL,hiddenTitle:!0,ac_load_btn:!0,priceSort:"asc",placeholder:""}},components:{goodlist:i},props:{},onLoad:function(t){""!=t.keyWord&&this.setData({keyword:t.keyWord,placeholder:t.keyWord}),this.getHotWord(),this.getHistroyList()},onPullDownRefresh:function(){this.setData({page:1,shopList:[]}),this.searchProductData("downRefresh")},onReachBottom:function(){var t=this.searchValue;this.setData({page:this.page+1,keyword:t}),this.reachBottom&&this.searchProductData()},methods:{goHome:function(t){wx.switchTab({url:"../index/index"})},getHistroyList:function(){var t=o.getStorageSync("historyKeyList")||null;this.setData({historyKeyList:t})},doKeySearch:function(t){var e=t.currentTarget.dataset.key;this.setData({searchValue:e,hotKeyShow:!1,historyKeyShow:!1,shopList:[],page:1,hotAndHistoryHidden:!0,keyword:e}),this.shopList.length=0,this.getOrSetSearchHistory(e),this.searchProductData()},filter:function(t){var e=this;if(!e.ac_load_btn)return!1;var a=t.currentTarget.dataset.type;e.setData({sort:a}),"price"==a&&(this.priceSort="asc"==this.priceSort?"desc":"asc"),e.doSearch()},doSearch:function(){var t=this.searchValue.replace(/(^\s*)|(\s*$)/g,"");""!=t?t||this.keyword?(!t&&this.keyword&&(t=this.keyword,this.setData({searchValue:this.keyword})),this.setData({keyword:t,hotAndHistoryHidden:!0,shopList:[],page:1}),this.searchProductData(),this.getOrSetSearchHistory(t)):this.setData({focus:!0,hotAndHistoryHidden:!1}):o.toast("请输入您需要搜索的商品")},getOrSetSearchHistory:function(t){var e=this;o.getStorage({key:"historyKeyList"},function(a){var s=a.data,i=[],r=1;for(var n in s)s[n]!=t&&r<10&&(r++,i.push(s[n]));i.unshift(t),o.setStorage({key:"historyKeyList",data:i},function(t){e.setData({historyKeyList:i})})},function(e){var a=[];a.unshift(t),o.setStorage({key:"historyKeyList",data:a})})},searchValueInput:function(t){var e=t.detail.value;this.setData({searchValue:e,placeholder:"请输入您的搜索内容"}),e||0!=this.shopList.length||this.setData({hotKeyShow:!0,historyKeyShow:!0,keyword:""})},cancelSearch:function(){this.setData({searchValue:"",shopList:[],showEmpty:!1,hotAndHistoryHidden:!1,hiddenTitle:!0,keyword:"",placeholder:"请输入您的搜索内容"}),this.getHistroyList()},clearHistory:function(){var t=[],e=this;o.showModal("是否清空历史记录？","清空",function(a){a.confirm&&o.setStorage({key:"historyKeyList",data:t},function(a){e.setData({historyKeyList:t})})})},getHotWord:function(){var t=this,e=s.getPath.gethotword,a={is_default:0};o.ApiGateWayTest(e,a,!0,function(e){e&&e.data&&1==e.data.success&&t.setData({hotWord:e.data.result.data})})},searchProductData:function(t){var e=this;o.showLoad(e),e.ac_load_btn=!1;var a=s.getPath.searchlist,i={page:this.page,page_size:this.page_size,keyword:this.keyword,sort:this.sort};i.sort_asc="price"==this.sort?this.priceSort:"",o.ApiGateWayTest(a,i,!0,function(a){if(a&&a.data)if(1==a.data.success){var s=a.data.result.data;"downRefresh"==t&&wx.stopPullDownRefresh(),s.length<e.page_size?e.setData({reachBottom:!1}):e.setData({reachBottom:!0}),s.length>0?e.setData({shopList:e.shopList.concat(s),showEmpty:!1,hiddenTitle:!1}):e.shopList.length<=0&&e.setData({showEmpty:!0,hiddenTitle:!0})}else 0==a.data.success&&e.setData({reachBottom:!1});else o.toast("网络加载错误，请稍后重试");o.hideLoad(e),e.ac_load_btn=!0,o.hideLoad(e)})},setData:function(t){var e=this,a=[];Object.keys(t).forEach(function(s){a=s.split("."),t[s],e.$data,a.forEach(function(a,o){e[s]=t[s]})})}}};e.default=r},"4c08":function(t,e,a){"use strict";var s=a("5d4b"),o=a.n(s);o.a},"5d4b":function(t,e,a){},f2bf:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return o})},f884:function(t,e,a){"use strict";a.r(e);var s=a("4373"),o=a.n(s);for(var i in s)"default"!==i&&function(t){a.d(e,t,function(){return s[t]})}(i);e["default"]=o.a}},[["2047","common/runtime","common/vendor"]]]);