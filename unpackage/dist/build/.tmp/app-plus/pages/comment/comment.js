(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/comment/comment"],{"1d7c":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return o})},"3d5f":function(t,e,n){"use strict";n.r(e);var a=n("c85b"),o=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,function(){return a[t]})}(s);e["default"]=o.a},"60f2":function(t,e,n){},"9b5e":function(t,e,n){"use strict";var a=n("60f2"),o=n.n(a);o.a},a0e2:function(t,e,n){"use strict";n.r(e);var a=n("1d7c"),o=n("3d5f");for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);n("9b5e");var i=n("2877"),r=Object(i["a"])(o["default"],a["a"],a["b"],!1,null,null,null);e["default"]=r.exports},c85b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=getApp().globalData,o=n("28c1"),s={data:function(){return{iconURL:a.dataBase.iconURL,productId:0,subtotal:{},comments:{},commentsList:[],grade:0,page:0,page_size:5,limitWords:"展开",isLoading:!0,isLastPage:!1,comment:""}},components:{},props:{},onLoad:function(t){void 0!=t&&void 0!=t.productId?(this.productId=t.productId,this.getCommentsNum(),this.getComments()):o.toast("请求参数错误")},methods:{getCommentsNum:function(){var t=this;o.showLoad(t);var e="/Api/api.product.seeCommentsNum",n={product:this.productId};o.ApiGateWayTest(e,n,function(e){var n=e.error_code;if(0==n){var a=e.subtotal;t.setData({subtotal:a}),o.hideLoad(t)}else o.hideLoad(t),o.toast("网络错误")})},getComments:function(){if(!this.comments.paged||0!=this.comments.paged.more){this.comments.length>0&&this.setData({isLoading:!0});var t=this,e="/Api/api.product.seeComments";t.page=t.page+1;var n={grade:t.grade,page:t.page,page_size:t.page_size,product:t.productId};o.ApiGateWayTest(e,n,function(e){var n=e.error_code;if(0==n){var a=e,s=t.commentsList,i=s.length?s.length:0;for(var r in a.reviews)a.reviews[r]&&s.push(a.reviews[r]),s[i].content.length>248?(s[i].words=!0,s[i].wordsCut=!0):(s[i].words=!1,s[i].wordsCut=!1),i++;t.setData({comments:a,commentsList:s,isLoading:!1,isLastPage:0==e.paged.more})}else o.toast("网络错误")})}},setCommentImage:function(t){for(var e=this.commentsList,n=t.currentTarget.dataset.current,a=t.currentTarget.dataset.idx,o=[],s=0;e[a].imgInfo.length>s;s++)o.push(e[a].imgInfo[s].img);wx.previewImage({current:n,urls:o})},setAgainImage:function(t){for(var e=this.commentsList,n=t.currentTarget.dataset.current,a=t.currentTarget.dataset.idx,o=[],s=0;e[a].again_info.imgInfo.length>s;s++)o.push(e[a].again_info.imgInfo[s].img);wx.previewImage({current:n,urls:o})},limitWord:function(t){var e=t.currentTarget.dataset.iscut,n=t.currentTarget.dataset.listnum;this.comment[n].wordsCut=!e,e?this.setData({comment:this.comment,limitWords:"收起"}):this.setData({comment:this.comment,limitWords:"展开"})},getCommentType:function(t){var e=t.currentTarget.dataset.type;this.setData({grade:e,page:0,isLoading:!0,comments:{},commentsList:[]}),this.getComments()},setData:function(t){var e=this,n=[];Object.keys(t).forEach(function(a){n=a.split("."),t[a],e.$data,n.forEach(function(n,o){e[a]=t[a]})})}}};e.default=s}},[["d8c0","common/runtime","common/vendor"]]]);