(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packageA/takeout-order/takeout-order"],{"0ea7":function(t,e,a){"use strict";a.r(e);var r=a("9762"),o=a.n(r);for(var n in r)"default"!==n&&function(t){a.d(e,t,function(){return r[t]})}(n);e["default"]=o.a},"54a6":function(t,e,a){"use strict";a.r(e);var r=a("a80b"),o=a("0ea7");for(var n in o)"default"!==n&&function(t){a.d(e,t,function(){return o[t]})}(n);a("6f5a");var i=a("2877"),s=Object(i["a"])(o["default"],r["a"],r["b"],!1,null,null,null);e["default"]=s.exports},"6f5a":function(t,e,a){"use strict";var r=a("a660"),o=a.n(r);o.a},9762:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=getApp().globalData,o=a("28c1"),n={data:function(){return{iconURL:r.dataBase.iconURL,tab_change:0,page_size:5,page:1,orders:[],backorders:[],isShowGoHome:!1,entryData:""}},components:{},props:{},onLoad:function(t){var e=this;t.tab_change&&e.setData({tab_change:t.tab_change});e=this;t&&t.entryType&&"external"==t.entryType?this.setData({isShowGoHome:!1}):this.setData({isShowGoHome:!0}),this.setData({entryData:t});t=e.entryData;var a=o.getStorageSync("getpickup");t&&(t.atitude||t.pickup_id)&&!a&&e.getExternal(t.pickup_id).then(function(){r.firstlaunchApp=!1,e.entryData={},o.setStorageSync("authSetting",{"scope.userLocation":!0})})},onShow:function(){this.page=1,this.page_size=5,this.orders=[],this.backorders=[],wx.pageScrollTo({scrollTop:0,duration:50}),this.getOrderList(),this.getBackOrderList()},onPullDownRefresh:function(){var t=this;t.orders=[],t.backorders=[],t.page=1,t.page_size=5,t.getOrderList(),t.getBackOrderList()},onReachBottom:function(){var t=this;t.orders&&t.orders.length%t.page_size==0&&(t.page=t.orders.length/t.page_size+1,4!=this.tab_change?t.getOrderList():t.getBackOrderList())},methods:{getExternal:function(t){var e=r.getPath.getpickup,a={pickup_id:t};return new Promise(function(t,r){o.ApiGateWayTest(e,a,!0,function(e){if(e&&e.data&&1==e.data.success){e=e.data.result.cities.pick_up;o.setStorage({key:"getpickup",data:{pickup_id:e.pickup_id,cityName:e.pickup_name,pickup_address:e.pickup_address,pickup_contact:e.pickup_contact,pickup_phone:e.pickup_phone,pickup_type:e.pickup_type}},function(e){t("获取id成功")}),o.setStorage({key:"city",data:{pickup_id:e.pickup_id,warehouse_id:e.warehouse_id,cityName:e.city_name,is_pick_up:1}})}})})},swichNav:function(t){var e=this;o.showLoad(e),e.setData({tab_change:t.currentTarget.dataset.tab}),this.onPullDownRefresh()},getOrderList:function(){var t=this,e=r.getPath.shopOrderList,a={page:t.page,page_size:t.page_size,status:this.tab_change};o.ApiGateWayTest(e,a,!0,function(e){e=e.data;var a=e.result.data;1===e.success?(t.orders=t.orders?t.orders.concat(a):a,t.setData({orders:t.orders}),o.hideLoad(t)):o.toast(e.data.msg)})},getBackOrderList:function(){var t=this,e=r.getPath.shopOrderBack,a={page:t.page,page_size:t.page_size};o.ApiGateWayTest(e,a,!0,function(e){e=e.data;var a=e.result.orderBackInfo;1===e.success?(t.backorders=t.backorders?t.backorders.concat(a):a,t.setData({backorders:t.backorders}),o.hideLoad(t)):o.toast(e.data.msg)})},goBackOrderDetail:function(t){var e=t.currentTarget.dataset.orderid;wx.navigateTo({url:"./order-back?entryType=external&order_id="+e})},touchCancel:function(t){var e=this,a=t.currentTarget.dataset.orderId,n=r.getPath.shopCancelOrder,i={order_id:a},s="是否取消该订单？",c="确定";o.showModal(s,c,function(t){t.confirm&&o.ApiGateWayTest(n,i,!0,function(t){1==t.data.success?(wx.pageScrollTo({scrollTop:0,duration:100}),o.toast(t.data.msg),e.onPullDownRefresh()):o.toast(t.data.msg)})})},goOrderDetail:function(t){var e=t.currentTarget.dataset.orderid;wx.navigateTo({url:"./order-detail?entryType=external&order_id="+e})},touchPay:function(t){var e=this,a=t.currentTarget.dataset.orderId,n=r.getPath.doPay,i={order_type:2,order_id:a,payment_code:"wxpay"};o.ApiGateWayTest(n,i,!0,function(t){if(1==t.data.success){var r=t.data.result;o.doWechatPay(r,function(t){o.toast("支付成功"),e.checkPay(a)},function(t){o.toast("支付失败"),wx.pageScrollTo({scrollTop:0,duration:100})})}})},touchConfirm:function(t){var e=this,a=t.currentTarget.dataset.orderId,n=r.getPath.confirmReceive,i={order_id:a},s="你确定已收到宝贝吗？",c="确定";o.showModal(s,c,function(t){t.confirm&&o.ApiGateWayTest(n,i,!0,function(t){1==t.data.success?(wx.pageScrollTo({scrollTop:0,duration:100}),o.toast(t.data.msg),e.onPullDownRefresh()):o.toast(t.data.msg)})})},checkPay:function(t){var e=this,a=r.getPath.checkPay,n={order_id:t,order_type:2};o.ApiGateWayTest(a,n,!0,function(t){wx.pageScrollTo({scrollTop:0,duration:100}),e.onPullDownRefresh()})},touchExpress:function(t){var e=t.currentTarget.dataset;wx.navigateTo({url:"../user/order-express?order="+e.order.order_id+"&delivery_id="+e.delivery_id})},touchComment:function(t){var e=t.currentTarget.dataset.orderId;wx.navigateTo({url:"../user/order-review?order="+e})},touchSubComment:function(t){var e=t.currentTarget.dataset.orderId;wx.navigateTo({url:"../user/add-order-review?order="+e})},refund:function(t){var e=t.target.dataset.orderId;wx.navigateTo({url:"/packageA/user/application-return?type=1&orderId="+e})},gotoHome:function(){wx.switchTab({url:"/pages/index/index"})},phoneCall:function(){o.phoneCall(r.globalData.hotline)},unLoad:function(){},golinkkf:function(){r.dataBase.pageUrl="http://q.url.cn/s/6l3eQOm?_type=wpa&_wv=2",o.goWebview()},setData:function(t){var e=this,a=[];Object.keys(t).forEach(function(r){a=r.split("."),t[r],e.$data,a.forEach(function(a,o){e[r]=t[r]})})}}};e.default=n},a660:function(t,e,a){},a80b:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"a",function(){return r}),a.d(e,"b",function(){return o})}},[["b2a9","common/runtime","common/vendor"]]]);